{"version":3,"file":"contact-intent-xyA8U_lR.js","sources":["../../server/routes/contact-intent.ts"],"sourcesContent":["import type { RequestHandler } from \"express\";\nimport { z } from \"zod\";\nimport { promises as fs } from \"fs\";\nimport path from \"path\";\n\nconst intentSchema = z.object({\n  type: z.enum([\"email\", \"github\", \"linkedin\"]),\n  value: z.string().optional(),\n  timestamp: z.string().optional(),\n});\n\nexport const handleContactIntent: RequestHandler = async (req, res) => {\n  const parsed = intentSchema.safeParse(req.body);\n  if (!parsed.success) {\n    return res.status(400).json({ success: false });\n  }\n  const dataDir = path.join(process.cwd(), \"server\", \"data\");\n  const filePath = path.join(dataDir, \"contact-intents.json\");\n  await fs.mkdir(dataDir, { recursive: true });\n  const record = { ...parsed.data, timestamp: new Date().toISOString() };\n  let existing: unknown[] = [];\n  try {\n    const raw = await fs.readFile(filePath, \"utf8\");\n    existing = JSON.parse(raw);\n    if (!Array.isArray(existing)) existing = [];\n  } catch {\n    existing = [];\n  }\n  existing.push(record);\n  await fs.writeFile(filePath, JSON.stringify(existing, null, 2), \"utf8\");\n  return res.json({ success: true });\n};\n"],"names":["fs"],"mappings":";;;AAKA,MAAM,eAAe,EAAE,OAAO;AAAA,EAC5B,MAAM,EAAE,KAAK,CAAC,SAAS,UAAU,UAAU,CAAC;AAAA,EAC5C,OAAO,EAAE,OAAA,EAAS,SAAA;AAAA,EAClB,WAAW,EAAE,OAAA,EAAS,SAAA;AACxB,CAAC;AAEM,MAAM,sBAAsC,OAAO,KAAK,QAAQ;AACrE,QAAM,SAAS,aAAa,UAAU,IAAI,IAAI;AAC9C,MAAI,CAAC,OAAO,SAAS;AACnB,WAAO,IAAI,OAAO,GAAG,EAAE,KAAK,EAAE,SAAS,OAAO;AAAA,EAChD;AACA,QAAM,UAAU,KAAK,KAAK,QAAQ,IAAA,GAAO,UAAU,MAAM;AACzD,QAAM,WAAW,KAAK,KAAK,SAAS,sBAAsB;AAC1D,QAAMA,SAAG,MAAM,SAAS,EAAE,WAAW,MAAM;AAC3C,QAAM,SAAS,EAAE,GAAG,OAAO,MAAM,YAAW,oBAAI,QAAO,cAAY;AACnE,MAAI,WAAsB,CAAA;AAC1B,MAAI;AACF,UAAM,MAAM,MAAMA,SAAG,SAAS,UAAU,MAAM;AAC9C,eAAW,KAAK,MAAM,GAAG;AACzB,QAAI,CAAC,MAAM,QAAQ,QAAQ,cAAc,CAAA;AAAA,EAC3C,QAAQ;AACN,eAAW,CAAA;AAAA,EACb;AACA,WAAS,KAAK,MAAM;AACpB,QAAMA,SAAG,UAAU,UAAU,KAAK,UAAU,UAAU,MAAM,CAAC,GAAG,MAAM;AACtE,SAAO,IAAI,KAAK,EAAE,SAAS,MAAM;AACnC;"}